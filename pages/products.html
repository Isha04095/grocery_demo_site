<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Products - FreshCart | Fresh Groceries Delivered Fast</title>
    <meta name="description" content="Browse our extensive collection of fresh groceries. From organic produce to daily essentials - find everything you need with fast delivery.">
    <link rel="stylesheet" href="../css/main.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Poppins:wght@500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <script type="module" src="https://static.rocket.new/rocket-web.js?_cfg=https%3A%2F%2Ffreshcart2455back.builtwithrocket.new&_be=https%3A%2F%2Fapplication.rocket.new&_v=0.1.9"></script>
  <script type="module" src="https://static.rocket.new/rocket-shot.js?v=0.0.1"></script>
  </head>
<body class="bg-background">
    <!-- Preloader -->
    <div id="preloader" class="fixed inset-0 bg-white z-50 flex items-center justify-center">
        <div class="animate-spin rounded-full h-16 w-16 border-t-4 border-primary"></div>
    </div>

    <!-- Navigation -->
    <nav id="navbar" class="fixed top-0 left-0 right-0 bg-white/95 backdrop-blur-md shadow-subtle z-40 transition-all duration-300">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <!-- Logo -->
                <div class="flex items-center">
                    <svg class="h-10 w-10 text-primary mr-3" viewBox="0 0 40 40" fill="currentColor">
                        <path d="M20 2L35 10v20L20 38 5 30V10L20 2z"/>
                        <path d="M15 18h10v2H15zm0 4h10v2H15zm0 4h6v2h-6z" fill="white"/>
                    </svg>
                    <span class="text-2xl font-bold text-primary heading-poppins">FreshCart</span>
                </div>

                <!-- Desktop Navigation -->
                <div class="hidden md:flex items-center space-x-8">
                    <a href="homepage.html" class="text-text-secondary hover:text-primary transition-colors">Home</a>
                    <a href="products.html" class="text-text-primary hover:text-primary transition-colors font-medium">Products</a>
                    <a href="offers.html" class="text-text-secondary hover:text-primary transition-colors">Offers</a>
                    <a href="about.html" class="text-text-secondary hover:text-primary transition-colors">About</a>
                    <a href="contact.html" class="text-text-secondary hover:text-primary transition-colors">Contact</a>
                    <button id="cart-btn" class="btn-primary">
                        <i class="fas fa-shopping-cart mr-2"></i>Cart (<span id="cart-count">0</span>)
                    </button>
                </div>

                <!-- Mobile Menu Button -->
                <button id="mobile-menu-btn" class="md:hidden p-2 rounded-lg hover:bg-gray-100 transition-colors">
                    <i class="fas fa-bars text-xl"></i>
                </button>
            </div>
        </div>

        <!-- Mobile Menu -->
        <div id="mobile-menu" class="md:hidden bg-white border-t border-border-light transform -translate-y-full opacity-0 transition-all duration-300">
            <div class="px-4 py-4 space-y-4">
                <a href="homepage.html" class="block text-text-secondary hover:text-primary transition-colors">Home</a>
                <a href="products.html" class="block text-text-primary hover:text-primary transition-colors font-medium">Products</a>
                <a href="offers.html" class="block text-text-secondary hover:text-primary transition-colors">Offers</a>
                <a href="about.html" class="block text-text-secondary hover:text-primary transition-colors">About</a>
                <a href="contact.html" class="block text-text-secondary hover:text-primary transition-colors">Contact</a>
                <button class="btn-primary w-full mt-4">
                    <i class="fas fa-shopping-cart mr-2"></i>Cart (<span id="mobile-cart-count">0</span>)
                </button>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="relative bg-gradient-to-r from-primary-50 to-accent-50 pt-24 pb-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-8">
                <h1 class="text-4xl md:text-5xl font-bold text-text-primary mb-4 heading-poppins">Fresh Groceries</h1>
                <p class="text-xl text-text-secondary max-w-2xl mx-auto">Discover quality products delivered to your doorstep in minutes</p>
            </div>

            <!-- Search Bar -->
            <div class="max-w-2xl mx-auto mb-8">
                <div class="relative">
                    <input type="text" 
                           id="search-input"
                           placeholder="Search for groceries, fruits, vegetables..." 
                           class="w-full px-6 py-4 pr-16 rounded-xl text-lg border-0 shadow-elevated focus:ring-4 focus:ring-primary-200 transition-all">
                    <button id="search-btn" class="absolute right-2 top-1/2 transform -translate-y-1/2 bg-primary text-white px-6 py-2 rounded-lg hover:bg-primary-600 transition-colors">
                        <i class="fas fa-search"></i>
                    </button>
                </div>
            </div>

            <!-- Quick Category Pills -->
            <div class="flex flex-wrap justify-center gap-3 mb-8">
                <button class="category-pill active" data-category="all">All Products</button>
                <button class="category-pill" data-category="fruits">Fruits</button>
                <button class="category-pill" data-category="vegetables">Vegetables</button>
                <button class="category-pill" data-category="dairy">Dairy</button>
                <button class="category-pill" data-category="meat">Meat</button>
                <button class="category-pill" data-category="bakery">Bakery</button>
                <button class="category-pill" data-category="beverages">Beverages</button>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <section class="py-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex flex-col lg:flex-row gap-8">
                <!-- Sidebar Filters -->
                <div class="lg:w-1/4">
                    <div class="bg-white rounded-2xl shadow-subtle p-6 sticky top-24">
                        <div class="flex items-center justify-between mb-6">
                            <h3 class="text-xl font-semibold text-text-primary">Filters</h3>
                            <button id="clear-filters" class="text-primary hover:text-primary-600 text-sm font-medium">
                                <i class="fas fa-undo mr-1"></i>Clear All
                            </button>
                        </div>

                        <!-- Price Range -->
                        <div class="mb-6">
                            <h4 class="font-semibold text-text-primary mb-3">Price Range</h4>
                            <div class="space-y-2">
                                <label class="flex items-center">
                                    <input type="checkbox" class="price-filter mr-3" data-range="0-10">
                                    <span class="text-text-secondary">$0 - $10</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" class="price-filter mr-3" data-range="10-25">
                                    <span class="text-text-secondary">$10 - $25</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" class="price-filter mr-3" data-range="25-50">
                                    <span class="text-text-secondary">$25 - $50</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" class="price-filter mr-3" data-range="50+">
                                    <span class="text-text-secondary">$50+</span>
                                </label>
                            </div>
                        </div>

                        <!-- Dietary Preferences -->
                        <div class="mb-6">
                            <h4 class="font-semibold text-text-primary mb-3">Dietary</h4>
                            <div class="space-y-2">
                                <label class="flex items-center">
                                    <input type="checkbox" class="dietary-filter mr-3" data-diet="organic">
                                    <span class="text-text-secondary">Organic</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" class="dietary-filter mr-3" data-diet="gluten-free">
                                    <span class="text-text-secondary">Gluten Free</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" class="dietary-filter mr-3" data-diet="vegan">
                                    <span class="text-text-secondary">Vegan</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" class="dietary-filter mr-3" data-diet="keto">
                                    <span class="text-text-secondary">Keto Friendly</span>
                                </label>
                            </div>
                        </div>

                        <!-- Availability -->
                        <div class="mb-6">
                            <h4 class="font-semibold text-text-primary mb-3">Availability</h4>
                            <div class="space-y-2">
                                <label class="flex items-center">
                                    <input type="checkbox" class="availability-filter mr-3" data-stock="in-stock">
                                    <span class="text-text-secondary">In Stock</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" class="availability-filter mr-3" data-stock="fast-delivery">
                                    <span class="text-text-secondary">Fast Delivery</span>
                                </label>
                            </div>
                        </div>

                        <!-- Brand Filter -->
                        <div class="mb-6">
                            <h4 class="font-semibold text-text-primary mb-3">Brands</h4>
                            <div class="space-y-2">
                                <label class="flex items-center">
                                    <input type="checkbox" class="brand-filter mr-3" data-brand="fresh-farms">
                                    <span class="text-text-secondary">Fresh Farms</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" class="brand-filter mr-3" data-brand="organic-valley">
                                    <span class="text-text-secondary">Organic Valley</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" class="brand-filter mr-3" data-brand="local-harvest">
                                    <span class="text-text-secondary">Local Harvest</span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Products Grid -->
                <div class="lg:w-3/4">
                    <!-- Sort and View Options -->
                    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-8 gap-4">
                        <div class="flex items-center gap-4">
                            <span class="text-text-secondary">Sort by:</span>
                            <select id="sort-select" class="px-4 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary-200 focus:border-primary">
                                <option value="featured">Featured</option>
                                <option value="price-low">Price: Low to High</option>
                                <option value="price-high">Price: High to Low</option>
                                <option value="rating">Customer Rating</option>
                                <option value="newest">Newest First</option>
                            </select>
                        </div>
                        <div class="flex items-center gap-2">
                            <button id="grid-view" class="p-2 rounded-lg bg-primary text-white">
                                <i class="fas fa-th-large"></i>
                            </button>
                            <button id="list-view" class="p-2 rounded-lg bg-gray-200 text-text-secondary hover:bg-gray-300">
                                <i class="fas fa-list"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Products Container -->
                    <div id="products-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                        <!-- Products will be dynamically loaded here -->
                    </div>

                    <!-- Load More Button -->
                    <div class="text-center mt-12">
                        <button id="load-more" class="btn-secondary px-8 py-4 text-lg">
                            Load More Products <i class="fas fa-chevron-down ml-2"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Recently Viewed Section -->
    <section class="py-16 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 class="text-3xl font-bold text-text-primary mb-8 heading-poppins">Recently Viewed</h2>
            <div id="recently-viewed" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <!-- Recently viewed products will be loaded here -->
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-text-primary text-white py-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8 mb-12">
                <!-- Company Info -->
                <div class="col-span-1 md:col-span-2">
                    <div class="flex items-center mb-6">
                        <svg class="h-10 w-10 text-primary mr-3" viewBox="0 0 40 40" fill="currentColor">
                            <path d="M20 2L35 10v20L20 38 5 30V10L20 2z"/>
                            <path d="M15 18h10v2H15zm0 4h10v2H15zm0 4h6v2h-6z" fill="white"/>
                        </svg>
                        <span class="text-2xl font-bold text-primary heading-poppins">FreshCart</span>
                    </div>
                    <p class="text-white/80 mb-6 max-w-md">
                        Your trusted partner for ultra-fast grocery delivery. Fresh, quality groceries delivered to your doorstep in minutes.
                    </p>
                    <div class="flex space-x-4">
                        <a href="javascript:void(0)" class="bg-white/10 p-3 rounded-full hover:bg-white/20 transition-colors">
                            <i class="fab fa-facebook-f"></i>
                        </a>
                        <a href="javascript:void(0)" class="bg-white/10 p-3 rounded-full hover:bg-white/20 transition-colors">
                            <i class="fab fa-twitter"></i>
                        </a>
                        <a href="javascript:void(0)" class="bg-white/10 p-3 rounded-full hover:bg-white/20 transition-colors">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a href="javascript:void(0)" class="bg-white/10 p-3 rounded-full hover:bg-white/20 transition-colors">
                            <i class="fab fa-linkedin-in"></i>
                        </a>
                    </div>
                </div>

                <!-- Quick Links -->
                <div>
                    <h3 class="font-semibold text-white mb-6">Quick Links</h3>
                    <ul class="space-y-3">
                        <li><a href="homepage.html" class="text-white/80 hover:text-primary transition-colors">Home</a></li>
                        <li><a href="products.html" class="text-white/80 hover:text-primary transition-colors">Products</a></li>
                        <li><a href="offers.html" class="text-white/80 hover:text-primary transition-colors">Offers</a></li>
                        <li><a href="about.html" class="text-white/80 hover:text-primary transition-colors">About Us</a></li>
                        <li><a href="contact.html" class="text-white/80 hover:text-primary transition-colors">Contact</a></li>
                    </ul>
                </div>

                <!-- Support -->
                <div>
                    <h3 class="font-semibold text-white mb-6">Support</h3>
                    <ul class="space-y-3">
                        <li><a href="javascript:void(0)" class="text-white/80 hover:text-primary transition-colors">Help Center</a></li>
                        <li><a href="javascript:void(0)" class="text-white/80 hover:text-primary transition-colors">Delivery Info</a></li>
                        <li><a href="javascript:void(0)" class="text-white/80 hover:text-primary transition-colors">Return Policy</a></li>
                        <li><a href="javascript:void(0)" class="text-white/80 hover:text-primary transition-colors">Privacy Policy</a></li>
                        <li><a href="javascript:void(0)" class="text-white/80 hover:text-primary transition-colors">Terms of Service</a></li>
                    </ul>
                </div>
            </div>

            <div class="border-t border-white/20 pt-8 text-center">
                <p class="text-white/80">© 2025 FreshCart. All Rights Reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Back to Top Button -->
    <button id="back-to-top" class="fixed bottom-8 right-8 bg-primary text-white p-4 rounded-full shadow-elevated hover:bg-primary-600 transition-all duration-300 opacity-0 invisible">
        <i class="fas fa-chevron-up"></i>
    </button>

    <!-- Product Quick View Modal -->
    <div id="quick-view-modal" class="fixed inset-0 bg-black/50 z-50 flex items-center justify-center opacity-0 invisible transition-all duration-300">
        <div class="bg-white rounded-2xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto">
            <div class="p-6">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-2xl font-bold text-text-primary">Product Details</h3>
                    <button id="close-modal" class="text-text-secondary hover:text-text-primary text-2xl">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div id="modal-content">
                    <!-- Modal content will be dynamically loaded -->
                </div>
            </div>
        </div>
    </div>

    <style>
        .category-pill {
            @apply px-4 py-2 rounded-full border border-border text-text-secondary hover:border-primary hover:text-primary transition-all duration-300;
        }
        
        .category-pill.active {
            @apply bg-primary text-white border-primary;
        }
        
        .product-card {
            @apply bg-white rounded-2xl shadow-subtle hover:shadow-elevated transition-all duration-300 overflow-hidden group cursor-pointer;
        }
        
        .product-image {
            @apply w-full h-48 object-cover group-hover:scale-105 transition-transform duration-300;
        }
        
        .stock-badge {
            @apply absolute top-4 left-4 px-3 py-1 rounded-full text-sm font-semibold;
        }
        
        .stock-badge.in-stock {
            @apply bg-success text-white;
        }
        
        .stock-badge.low-stock {
            @apply bg-warning text-white;
        }
        
        .stock-badge.out-of-stock {
            @apply bg-error text-white;
        }
        
        .dietary-badge {
            @apply inline-block px-2 py-1 bg-primary-50 text-primary text-xs rounded-full mr-1 mb-1;
        }
        
        .add-to-cart-btn {
            @apply w-full bg-primary text-white py-3 rounded-lg font-semibold hover:bg-primary-600 transition-colors flex items-center justify-center;
        }
        
        .add-to-cart-btn:disabled {
            @apply bg-gray-300 text-gray-500 cursor-not-allowed;
        }
        
        .quantity-selector {
            @apply flex items-center border border-border rounded-lg overflow-hidden;
        }
        
        .quantity-btn {
            @apply px-3 py-2 bg-gray-100 hover:bg-gray-200 transition-colors;
        }
        
        .quantity-input {
            @apply w-16 text-center border-0 focus:ring-0;
        }
    </style>

    <script>
        // Mock product data
        const products = [
            {
                id: 1,
                name: "Organic Bananas",
                category: "fruits",
                price: 3.99,
                originalPrice: 4.99,
                image: "https://images.unsplash.com/photo-1571771894821-ce9b6c11b08e?q=80&w=2940&auto=format&fit=crop",
                rating: 4.8,
                reviews: 124,
                description: "Fresh, ripe organic bananas - 1 dozen",
                stock: "in-stock",
                stockCount: 25,
                brand: "fresh-farms",
                dietary: ["organic"],
                deliveryTime: "10-15 mins",
                nutrition: { calories: 105, fiber: "3.1g", potassium: "422mg" },
                ingredients: ["Organic Bananas"],
                allergens: []
            },
            {
                id: 2,
                name: "Whole Milk",
                category: "dairy",
                price: 4.49,
                image: "https://images.unsplash.com/photo-1550258987-190a2d41a8ba?q=80&w=2940&auto=format&fit=crop",
                rating: 4.9,
                reviews: 89,
                description: "Farm fresh whole milk - 1 gallon",
                stock: "in-stock",
                stockCount: 15,
                brand: "organic-valley",
                dietary: [],
                deliveryTime: "8-12 mins",
                nutrition: { calories: 150, protein: "8g", calcium: "280mg" },
                ingredients: ["Whole Milk", "Vitamin D3"],
                allergens: ["milk"]
            },
            {
                id: 3,
                name: "Sourdough Bread",
                category: "bakery",
                price: 5.99,
                image: "https://images.unsplash.com/photo-1506976785307-8732e854ad03?q=80&w=2940&auto=format&fit=crop",
                rating: 4.7,
                reviews: 156,
                description: "Artisan sourdough bread - freshly baked",
                stock: "in-stock",
                stockCount: 8,
                brand: "local-harvest",
                dietary: [],
                deliveryTime: "15-20 mins",
                nutrition: { calories: 120, carbs: "22g", fiber: "2g" },
                ingredients: ["Wheat Flour", "Water", "Sourdough Starter", "Salt"],
                allergens: ["gluten"]
            },
            {
                id: 4,
                name: "Mixed Salad Greens",
                category: "vegetables",
                price: 6.99,
                image: "https://images.unsplash.com/photo-1498837167922-ddd27525d352?q=80&w=2940&auto=format&fit=crop",
                rating: 4.6,
                reviews: 78,
                description: "Organic mixed greens - ready to eat",
                stock: "in-stock",
                stockCount: 12,
                brand: "fresh-farms",
                dietary: ["organic", "vegan", "gluten-free"],
                deliveryTime: "10-15 mins",
                nutrition: { calories: 20, vitamin_a: "148%", vitamin_k: "181%" },
                ingredients: ["Organic Lettuce", "Organic Spinach", "Organic Arugula"],
                allergens: []
            },
            {
                id: 5,
                name: "Greek Yogurt",
                category: "dairy",
                price: 7.99,
                image: "https://images.pexels.com/photos/1435904/pexels-photo-1435904.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2",
                rating: 4.8,
                reviews: 203,
                description: "Creamy Greek yogurt - 32oz container",
                stock: "low-stock",
                stockCount: 3,
                brand: "organic-valley",
                dietary: ["organic"],
                deliveryTime: "8-12 mins",
                nutrition: { calories: 100, protein: "18g", probiotics: "Live cultures" },
                ingredients: ["Organic Milk", "Live Active Cultures"],
                allergens: ["milk"]
            },
            {
                id: 6,
                name: "Avocados",
                category: "fruits",
                price: 8.99,
                image: "https://images.pixabay.com/photo/2016/03/05/19/02/avocado-1238250_1280.jpg",
                rating: 4.5,
                reviews: 167,
                description: "Ripe Hass avocados - pack of 6",
                stock: "in-stock",
                stockCount: 20,
                brand: "fresh-farms",
                dietary: ["organic", "vegan", "keto"],
                deliveryTime: "10-15 mins",
                nutrition: { calories: 234, fiber: "10g", potassium: "690mg" },
                ingredients: ["Organic Avocados"],
                allergens: []
            },
            {
                id: 7,
                name: "Chicken Breast",
                category: "meat",
                price: 12.99,
                image: "https://images.unsplash.com/photo-1529692236671-f1f6cf9683ba?q=80&w=2940&auto=format&fit=crop",
                rating: 4.7,
                reviews: 92,
                description: "Fresh boneless chicken breast - 2 lbs",
                stock: "in-stock",
                stockCount: 18,
                brand: "local-harvest",
                dietary: ["keto"],
                deliveryTime: "15-20 mins",
                nutrition: { calories: 165, protein: "31g", fat: "3.6g" },
                ingredients: ["Fresh Chicken Breast"],
                allergens: []
            },
            {
                id: 8,
                name: "Orange Juice",
                category: "beverages",
                price: 4.99,
                image: "https://images.unsplash.com/photo-1544145945-f90425340c7e?q=80&w=2940&auto=format&fit=crop",
                rating: 4.4,
                reviews: 134,
                description: "Fresh squeezed orange juice - 64oz",
                stock: "in-stock",
                stockCount: 22,
                brand: "fresh-farms",
                dietary: ["organic"],
                deliveryTime: "8-12 mins",
                nutrition: { calories: 110, vitamin_c: "124%", folate: "10%" },
                ingredients: ["Organic Orange Juice"],
                allergens: []
            },
            {
                id: 9,
                name: "Gluten-Free Pasta",
                category: "pantry",
                price: 6.49,
                image: "https://images.pexels.com/photos/1279330/pexels-photo-1279330.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2",
                rating: 4.3,
                reviews: 87,
                description: "Brown rice pasta - gluten-free, 16oz",
                stock: "in-stock",
                stockCount: 14,
                brand: "organic-valley",
                dietary: ["gluten-free", "vegan"],
                deliveryTime: "12-18 mins",
                nutrition: { calories: 200, carbs: "44g", fiber: "2g" },
                ingredients: ["Brown Rice Flour", "Water"],
                allergens: []
            }
        ];

        let filteredProducts = [...products];
        let currentPage = 1;
        const productsPerPage = 6;
        let cart = JSON.parse(localStorage.getItem('freshcart_cart')) || [];
        let recentlyViewed = JSON.parse(localStorage.getItem('freshcart_recently_viewed')) || [];

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            initializePreloader();
            initializeNavigation();
            initializeFilters();
            initializeSearch();
            initializeCategoryPills();
            initializeSorting();
            renderProducts();
            updateCartCount();
            renderRecentlyViewed();
            initializeBackToTop();
        });

        // Preloader
        function initializePreloader() {
            window.addEventListener('load', function() {
                const preloader = document.getElementById('preloader');
                preloader.style.opacity = '0';
                setTimeout(() => {
                    preloader.style.display = 'none';
                }, 300);
            });
        }

        // Navigation
        function initializeNavigation() {
            const mobileMenuBtn = document.getElementById('mobile-menu-btn');
            const mobileMenu = document.getElementById('mobile-menu');
            
            mobileMenuBtn.addEventListener('click', function() {
                const isOpen = mobileMenu.style.transform === 'translateY(0px)';
                
                if (isOpen) {
                    mobileMenu.style.transform = 'translateY(-100%)';
                    mobileMenu.style.opacity = '0';
                } else {
                    mobileMenu.style.transform = 'translateY(0px)';
                    mobileMenu.style.opacity = '1';
                }
            });

            // Navbar scroll effect
            const navbar = document.getElementById('navbar');
            window.addEventListener('scroll', function() {
                if (window.scrollY > 100) {
                    navbar.classList.add('shadow-elevated');
                } else {
                    navbar.classList.remove('shadow-elevated');
                }
            });
        }

        // Search functionality
        function initializeSearch() {
            const searchInput = document.getElementById('search-input');
            const searchBtn = document.getElementById('search-btn');

            function performSearch() {
                const query = searchInput.value.toLowerCase().trim();
                if (query) {
                    filteredProducts = products.filter(product => 
                        product.name.toLowerCase().includes(query) ||
                        product.description.toLowerCase().includes(query) ||
                        product.category.toLowerCase().includes(query)
                    );
                } else {
                    filteredProducts = [...products];
                }
                applyFilters();
                renderProducts();
            }

            searchBtn.addEventListener('click', performSearch);
            searchInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    performSearch();
                }
            });
        }

        // Category pills
        function initializeCategoryPills() {
            const categoryPills = document.querySelectorAll('.category-pill');
            
            categoryPills.forEach(pill => {
                pill.addEventListener('click', function() {
                    // Remove active class from all pills
                    categoryPills.forEach(p => p.classList.remove('active'));
                    // Add active class to clicked pill
                    this.classList.add('active');
                    
                    const category = this.dataset.category;
                    if (category === 'all') {
                        filteredProducts = [...products];
                    } else {
                        filteredProducts = products.filter(product => product.category === category);
                    }
                    applyFilters();
                    renderProducts();
                });
            });
        }

        // Filters
        function initializeFilters() {
            const clearFiltersBtn = document.getElementById('clear-filters');
            
            clearFiltersBtn.addEventListener('click', function() {
                // Clear all filter checkboxes
                document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
                    checkbox.checked = false;
                });
                
                // Reset category pills
                document.querySelectorAll('.category-pill').forEach(pill => {
                    pill.classList.remove('active');
                });
                document.querySelector('.category-pill[data-category="all"]').classList.add('active');
                
                // Reset products
                filteredProducts = [...products];
                renderProducts();
            });

            // Add event listeners to all filter checkboxes
            document.querySelectorAll('.price-filter, .dietary-filter, .availability-filter, .brand-filter').forEach(checkbox => {
                checkbox.addEventListener('change', applyFilters);
            });
        }

        function applyFilters() {
            let filtered = [...filteredProducts];

            // Price filters
            const priceFilters = Array.from(document.querySelectorAll('.price-filter:checked')).map(cb => cb.dataset.range);
            if (priceFilters.length > 0) {
                filtered = filtered.filter(product => {
                    return priceFilters.some(range => {
                        if (range === '0-10') return product.price <= 10;
                        if (range === '10-25') return product.price > 10 && product.price <= 25;
                        if (range === '25-50') return product.price > 25 && product.price <= 50;
                        if (range === '50+') return product.price > 50;
                        return false;
                    });
                });
            }

            // Dietary filters
            const dietaryFilters = Array.from(document.querySelectorAll('.dietary-filter:checked')).map(cb => cb.dataset.diet);
            if (dietaryFilters.length > 0) {
                filtered = filtered.filter(product => {
                    return dietaryFilters.some(diet => product.dietary.includes(diet));
                });
            }

            // Brand filters
            const brandFilters = Array.from(document.querySelectorAll('.brand-filter:checked')).map(cb => cb.dataset.brand);
            if (brandFilters.length > 0) {
                filtered = filtered.filter(product => brandFilters.includes(product.brand));
            }

            // Availability filters
            const availabilityFilters = Array.from(document.querySelectorAll('.availability-filter:checked')).map(cb => cb.dataset.stock);
            if (availabilityFilters.length > 0) {
                filtered = filtered.filter(product => {
                    if (availabilityFilters.includes('in-stock')) return product.stock === 'in-stock';
                    if (availabilityFilters.includes('fast-delivery')) return parseInt(product.deliveryTime) <= 15;
                    return true;
                });
            }

            filteredProducts = filtered;
            renderProducts();
        }

        // Sorting
        function initializeSorting() {
            const sortSelect = document.getElementById('sort-select');
            
            sortSelect.addEventListener('change', function() {
                const sortBy = this.value;
                
                switch (sortBy) {
                    case 'price-low':
                        filteredProducts.sort((a, b) => a.price - b.price);
                        break;
                    case 'price-high':
                        filteredProducts.sort((a, b) => b.price - a.price);
                        break;
                    case 'rating':
                        filteredProducts.sort((a, b) => b.rating - a.rating);
                        break;
                    case 'newest':
                        filteredProducts.sort((a, b) => b.id - a.id);
                        break;
                    default:
                        // Featured - reset to original order
                        filteredProducts = filteredProducts.sort((a, b) => a.id - b.id);
                }
                
                renderProducts();
            });
        }

        // Render products
        function renderProducts() {
            const container = document.getElementById('products-container');
            const productsToShow = filteredProducts.slice(0, currentPage * productsPerPage);
            
            container.innerHTML = productsToShow.map(product => createProductCard(product)).join('');
            
            // Show/hide load more button
            const loadMoreBtn = document.getElementById('load-more');
            if (productsToShow.length >= filteredProducts.length) {
                loadMoreBtn.style.display = 'none';
            } else {
                loadMoreBtn.style.display = 'block';
            }
            
            // Add event listeners to product cards
            addProductEventListeners();
        }

        function createProductCard(product) {
            const isInCart = cart.some(item => item.id === product.id);
            const stockBadgeClass = product.stock === 'in-stock' ? 'in-stock' : 
                                   product.stock === 'low-stock' ? 'low-stock' : 'out-of-stock';
            
            return `
                <div class="product-card" data-product-id="${product.id}">
                    <div class="relative">
                        <img src="${product.image}" 
                             alt="${product.name} - ${product.description}" 
                             class="product-image"
                             onerror="this.src='https://images.unsplash.com/photo-1584824486509-112e4181ff6b?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D'; this.onerror=null;">
                        <div class="stock-badge ${stockBadgeClass}">
                            ${product.stock === 'in-stock' ? 'In Stock' : 
                              product.stock === 'low-stock' ? 'Low Stock' : 'Out of Stock'}
                        </div>
                        ${product.originalPrice ? `<div class="absolute top-4 right-4 bg-secondary text-white px-3 py-1 rounded-full text-sm font-semibold">
                            ${Math.round(((product.originalPrice - product.price) / product.originalPrice) * 100)}% OFF
                        </div>` : ''}
                        <button class="quick-view-btn absolute inset-0 bg-black/50 text-white opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-center justify-center">
                            <i class="fas fa-eye mr-2"></i>Quick View
                        </button>
                    </div>
                    <div class="p-6">
                        <div class="flex items-start justify-between mb-2">
                            <h3 class="font-semibold text-text-primary">${product.name}</h3>
                            <button class="wishlist-btn text-text-secondary hover:text-error transition-colors">
                                <i class="far fa-heart"></i>
                            </button>
                        </div>
                        <p class="text-text-secondary text-sm mb-3">${product.description}</p>
                        
                        <!-- Dietary badges -->
                        <div class="mb-3">
                            ${product.dietary.map(diet => `<span class="dietary-badge">${diet}</span>`).join('')}
                        </div>
                        
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center space-x-2">
                                <span class="text-2xl font-bold text-primary">$${product.price}</span>
                                ${product.originalPrice ? `<span class="text-text-secondary line-through">$${product.originalPrice}</span>` : ''}
                            </div>
                            <div class="flex items-center text-yellow-400">
                                <i class="fas fa-star"></i>
                                <span class="text-text-secondary ml-1">${product.rating}</span>
                                <span class="text-text-secondary text-sm ml-1">(${product.reviews})</span>
                            </div>
                        </div>
                        
                        <div class="flex items-center justify-between mb-4 text-sm text-text-secondary">
                            <span><i class="fas fa-truck mr-1"></i>${product.deliveryTime}</span>
                            <span><i class="fas fa-box mr-1"></i>${product.stockCount} left</span>
                        </div>
                        
                        <button class="add-to-cart-btn" data-product-id="${product.id}" ${product.stock === 'out-of-stock' ? 'disabled' : ''}>
                            <i class="fas fa-${isInCart ? 'check' : 'plus'} mr-2"></i>
                            ${isInCart ? 'Added to Cart' : 'Add to Cart'}
                        </button>
                    </div>
                </div>
            `;
        }

        function addProductEventListeners() {
            // Add to cart buttons
            document.querySelectorAll('.add-to-cart-btn').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const productId = parseInt(this.dataset.productId);
                    addToCart(productId);
                });
            });

            // Quick view buttons
            document.querySelectorAll('.quick-view-btn').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const productId = parseInt(this.closest('.product-card').dataset.productId);
                    showQuickView(productId);
                });
            });

            // Product cards (for recently viewed)
            document.querySelectorAll('.product-card').forEach(card => {
                card.addEventListener('click', function() {
                    const productId = parseInt(this.dataset.productId);
                    addToRecentlyViewed(productId);
                });
            });

            // Wishlist buttons
            document.querySelectorAll('.wishlist-btn').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    this.innerHTML = this.innerHTML.includes('far') ? 
                        '<i class="fas fa-heart"></i>' : '<i class="far fa-heart"></i>';
                });
            });
        }

        // Cart functionality
        function addToCart(productId) {
            const product = products.find(p => p.id === productId);
            if (!product || product.stock === 'out-of-stock') return;

            const existingItem = cart.find(item => item.id === productId);
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({ ...product, quantity: 1 });
            }

            localStorage.setItem('freshcart_cart', JSON.stringify(cart));
            updateCartCount();
            
            // Update button state
            const btn = document.querySelector(`[data-product-id="${productId}"]`);
            if (btn) {
                btn.innerHTML = '<i class="fas fa-check mr-2"></i>Added to Cart';
                btn.classList.add('bg-success');
                btn.classList.remove('bg-primary');
                
                setTimeout(() => {
                    btn.innerHTML = '<i class="fas fa-check mr-2"></i>Added to Cart';
                }, 2000);
            }
        }

        function updateCartCount() {
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            document.getElementById('cart-count').textContent = totalItems;
            document.getElementById('mobile-cart-count').textContent = totalItems;
        }

        // Recently viewed
        function addToRecentlyViewed(productId) {
            const product = products.find(p => p.id === productId);
            if (!product) return;

            // Remove if already exists
            recentlyViewed = recentlyViewed.filter(item => item.id !== productId);
            
            // Add to beginning
            recentlyViewed.unshift(product);
            
            // Keep only last 8 items
            recentlyViewed = recentlyViewed.slice(0, 8);
            
            localStorage.setItem('freshcart_recently_viewed', JSON.stringify(recentlyViewed));
            renderRecentlyViewed();
        }

        function renderRecentlyViewed() {
            const container = document.getElementById('recently-viewed');
            if (recentlyViewed.length === 0) {
                container.innerHTML = '<p class="text-text-secondary col-span-full text-center">No recently viewed products</p>';
                return;
            }

            container.innerHTML = recentlyViewed.slice(0, 4).map(product => `
                <div class="product-card" data-product-id="${product.id}">
                    <div class="relative">
                        <img src="${product.image}" 
                             alt="${product.name} - ${product.description}" 
                             class="product-image"
                             onerror="this.src='https://images.unsplash.com/photo-1584824486509-112e4181ff6b?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D'; this.onerror=null;">
                    </div>
                    <div class="p-4">
                        <h3 class="font-semibold text-text-primary mb-2">${product.name}</h3>
                        <div class="flex items-center justify-between">
                            <span class="text-lg font-bold text-primary">$${product.price}</span>
                            <div class="flex items-center text-yellow-400">
                                <i class="fas fa-star"></i>
                                <span class="text-text-secondary ml-1">${product.rating}</span>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Quick view modal
        function showQuickView(productId) {
            const product = products.find(p => p.id === productId);
            if (!product) return;

            const modal = document.getElementById('quick-view-modal');
            const modalContent = document.getElementById('modal-content');
            
            modalContent.innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div>
                        <img src="${product.image}" 
                             alt="${product.name} - ${product.description}" 
                             class="w-full h-96 object-cover rounded-xl"
                             onerror="this.src='https://images.unsplash.com/photo-1584824486509-112e4181ff6b?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D'; this.onerror=null;">
                    </div>
                    <div>
                        <h2 class="text-3xl font-bold text-text-primary mb-4">${product.name}</h2>
                        <p class="text-text-secondary mb-4">${product.description}</p>
                        
                        <div class="flex items-center space-x-4 mb-4">
                            <span class="text-3xl font-bold text-primary">$${product.price}</span>
                            ${product.originalPrice ? `<span class="text-text-secondary line-through text-xl">$${product.originalPrice}</span>` : ''}
                            <div class="flex items-center text-yellow-400">
                                <i class="fas fa-star"></i>
                                <span class="text-text-secondary ml-1">${product.rating} (${product.reviews} reviews)</span>
                            </div>
                        </div>
                        
                        <div class="mb-4">
                            ${product.dietary.map(diet => `<span class="dietary-badge">${diet}</span>`).join('')}
                        </div>
                        
                        <div class="grid grid-cols-2 gap-4 mb-6 text-sm">
                            <div><strong>Delivery:</strong> ${product.deliveryTime}</div>
                            <div><strong>Stock:</strong> ${product.stockCount} available</div>
                            <div><strong>Brand:</strong> ${product.brand.replace('-', ' ')}</div>
                            <div><strong>Category:</strong> ${product.category}</div>
                        </div>
                        
                        <div class="mb-6">
                            <h4 class="font-semibold mb-2">Nutrition Facts</h4>
                            <div class="grid grid-cols-3 gap-2 text-sm">
                                ${Object.entries(product.nutrition).map(([key, value]) => 
                                    `<div><strong>${key}:</strong> ${value}</div>`
                                ).join('')}
                            </div>
                        </div>
                        
                        <div class="mb-6">
                            <h4 class="font-semibold mb-2">Ingredients</h4>
                            <p class="text-sm text-text-secondary">${product.ingredients.join(', ')}</p>
                            ${product.allergens.length > 0 ? `
                                <div class="mt-2">
                                    <strong class="text-error">Allergens:</strong> 
                                    <span class="text-sm">${product.allergens.join(', ')}</span>
                                </div>
                            ` : ''}
                        </div>
                        
                        <div class="flex gap-4">
                            <div class="quantity-selector">
                                <button class="quantity-btn" onclick="changeQuantity(-1)">-</button>
                                <input type="number" value="1" min="1" class="quantity-input" id="modal-quantity">
                                <button class="quantity-btn" onclick="changeQuantity(1)">+</button>
                            </div>
                            <button class="add-to-cart-btn flex-1" onclick="addToCartFromModal(${product.id})" ${product.stock === 'out-of-stock' ? 'disabled' : ''}>
                                <i class="fas fa-plus mr-2"></i>Add to Cart
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            modal.classList.remove('opacity-0', 'invisible');
            modal.classList.add('opacity-100', 'visible');
        }

        function changeQuantity(delta) {
            const input = document.getElementById('modal-quantity');
            const newValue = Math.max(1, parseInt(input.value) + delta);
            input.value = newValue;
        }

        function addToCartFromModal(productId) {
            const quantity = parseInt(document.getElementById('modal-quantity').value);
            const product = products.find(p => p.id === productId);
            
            const existingItem = cart.find(item => item.id === productId);
            if (existingItem) {
                existingItem.quantity += quantity;
            } else {
                cart.push({ ...product, quantity });
            }
            
            localStorage.setItem('freshcart_cart', JSON.stringify(cart));
            updateCartCount();
            
            // Close modal
            document.getElementById('close-modal').click();
        }

        // Modal close functionality
        document.getElementById('close-modal').addEventListener('click', function() {
            const modal = document.getElementById('quick-view-modal');
            modal.classList.add('opacity-0', 'invisible');
            modal.classList.remove('opacity-100', 'visible');
        });

        // Load more functionality
        document.getElementById('load-more').addEventListener('click', function() {
            currentPage++;
            renderProducts();
        });

        // Back to top
        function initializeBackToTop() {
            const backToTopBtn = document.getElementById('back-to-top');
            
            window.addEventListener('scroll', function() {
                if (window.scrollY > 300) {
                    backToTopBtn.classList.remove('opacity-0', 'invisible');
                    backToTopBtn.classList.add('opacity-100', 'visible');
                } else {
                    backToTopBtn.classList.add('opacity-0', 'invisible');
                    backToTopBtn.classList.remove('opacity-100', 'visible');
                }
            });

            backToTopBtn.addEventListener('click', function() {
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            });
        }

        // View toggle functionality
        document.getElementById('grid-view').addEventListener('click', function() {
            this.classList.add('bg-primary', 'text-white');
            this.classList.remove('bg-gray-200', 'text-text-secondary');
            document.getElementById('list-view').classList.add('bg-gray-200', 'text-text-secondary');
            document.getElementById('list-view').classList.remove('bg-primary', 'text-white');
            
            document.getElementById('products-container').className = 'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8';
        });

        document.getElementById('list-view').addEventListener('click', function() {
            this.classList.add('bg-primary', 'text-white');
            this.classList.remove('bg-gray-200', 'text-text-secondary');
            document.getElementById('grid-view').classList.add('bg-gray-200', 'text-text-secondary');
            document.getElementById('grid-view').classList.remove('bg-primary', 'text-white');
            
            document.getElementById('products-container').className = 'grid grid-cols-1 gap-6';
        });
    </script>
<script id="dhws-dataInjector" src="../public/dhws-data-injector.js"></script>
</body>
</html>